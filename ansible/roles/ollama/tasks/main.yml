---
# Ollama LLM server installation
# https://ollama.com/

- name: Download Ollama installation script
  ansible.builtin.get_url:
    url: https://ollama.com/install.sh
    dest: /tmp/ollama_install.sh
    mode: '0755'

- name: Install Ollama
  ansible.builtin.shell: /tmp/ollama_install.sh
  args:
    creates: /usr/local/bin/ollama

- name: Start and enable Ollama service
  ansible.builtin.systemd:
    name: ollama
    enabled: yes
    state: started
  ignore_errors: yes

- name: Wait for Ollama service
  ansible.builtin.wait_for:
    port: 11434
    host: localhost
    delay: 5
    timeout: 60
  ignore_errors: yes
